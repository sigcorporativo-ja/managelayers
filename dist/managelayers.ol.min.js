!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=9)}([function(t,e){t.exports='<div class="m-control m-managelayers-{{baseName}}">\n\t<div id="toolbar-button-{{baseName}}" class="m-toolbar-button m-toolbar-button-{{baseName}}">\n\t\t<button id="tool-btn-{{baseName}}" class="m-tool-button {{iconClass}}" title="{{tooltip}}"></button>\n\t</div>\n\t<div id="toolbar-container-{{baseName}}" class="m-toolbar-container m-toolbar-container-{{baseName}} dNone" title="">\n\t\t<div id="tool-{{baseName}}" class="m-tool-container m-tool-container-{{baseName}}">\n\t\t</div>\n\t</div>\n</div>'},function(t,e,n){var r,a;function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*! Sortable 1.7.0 - MIT | git://github.com/rubaxa/Sortable.git */!function(o){"use strict";void 0===(a="function"==typeof(r=function(){function t(e,n){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(e);this.el=e,this.options=n=g({},n),e[X]=this;var r={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(e.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==t.supportPointer};for(var i in r)!(i in n)&&(n[i]=r[i]);for(var o in lt(n),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!n.forceFallback&&$,a(e,"mousedown",this._onTapStart),a(e,"touchstart",this._onTapStart),n.supportPointer&&a(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(a(e,"dragover",this),a(e,"dragenter",this)),it.push(this._onDragOver),n.store&&this.sort(n.store.get(this))}function e(t,e){"clone"!==t.lastPullMode&&(e=!0),w&&w.state!==e&&(s(w,"display",e?"none":""),e||w.state&&(t.options.group.revertClone?(S.insertBefore(w,C),t._animate(L,w)):S.insertBefore(w,L)),w.state=e)}function n(t,e,n){if(t){n=n||Z;do{if(">*"===e&&t.parentNode===n||h(t,e))return t}while(t=r(t))}return null}function r(t){var e=t.host;return e&&e.nodeType?e:t.parentNode}function a(t,e,n){t.addEventListener(e,n,K)}function o(t,e,n){t.removeEventListener(e,n,K)}function l(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(V," ").replace(" "+e+" "," ");t.className=(r+(n?" "+e:"")).replace(V," ")}}function s(t,e,n){var r=t&&t.style;if(r){if(void 0===n)return Z.defaultView&&Z.defaultView.getComputedStyle?n=Z.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in r||(e="-webkit-"+e),r[e]=n+("string"==typeof n?"":"px")}}function c(t,e,n){if(t){var r=t.getElementsByTagName(e),a=0,i=r.length;if(n)for(;a<i;a++)n(r[a],a);return r}return[]}function u(t,e,n,r,a,i,o,l){t=t||e[X];var s=Z.createEvent("Event"),c=t.options,u="on"+n.charAt(0).toUpperCase()+n.substr(1);s.initEvent(n,!0,!0),s.to=a||e,s.from=i||e,s.item=r||e,s.clone=w,s.oldIndex=o,s.newIndex=l,e.dispatchEvent(s),c[u]&&c[u].call(t,s)}function p(t,e,n,r,a,i,o,l){var s,c,u=t[X],p=u.options.onMove;return(s=Z.createEvent("Event")).initEvent("move",!0,!0),s.to=e,s.from=t,s.dragged=n,s.draggedRect=r,s.related=a||e,s.relatedRect=i||e.getBoundingClientRect(),s.willInsertAfter=l,t.dispatchEvent(s),p&&(c=p.call(u,s,o)),c}function f(t){t.draggable=!1}function y(){et=!1}function d(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,r=0;n--;)r+=e.charCodeAt(n);return r.toString(36)}function m(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"===t.nodeName.toUpperCase()||">*"!==e&&!h(t,e)||n++;return n}function h(t,e){if(t){var n=(e=e.split(".")).shift().toUpperCase(),r=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");return!(""!==n&&t.nodeName.toUpperCase()!=n||e.length&&((" "+t.className+" ").match(r)||[]).length!=e.length)}return!1}function v(t,e){var n,r;return function(){void 0===n&&(n=arguments,r=this,z((function(){1===n.length?t.call(r,n[0]):t.apply(r,n),n=void 0}),e))}}function g(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function b(t){return J&&J.dom?J.dom(t).cloneNode(!0):Q?Q(t).clone(!0)[0]:t.cloneNode(!0)}function M(t){return z(t,0)}function _(t){return clearTimeout(t)}if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var L,E,O,w,S,C,k,N,T,P,x,A,I,j,D,R,B,W,q,U,F={},V=/\s+/g,H=/left|right|inline/,X="Sortable"+(new Date).getTime(),G=window,Z=G.document,Y=G.parseInt,z=G.setTimeout,Q=G.jQuery||G.Zepto,J=G.Polymer,K=!1,$="draggable"in Z.createElement("div"),tt=function(t){return!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie)/i)&&((t=Z.createElement("x")).style.cssText="pointer-events:auto","auto"===t.style.pointerEvents)}(),et=!1,nt=Math.abs,rt=Math.min,at=[],it=[],ot=v((function(t,e,n){if(n&&e.scroll){var r,a,i,o,l,s,c=n[X],u=e.scrollSensitivity,p=e.scrollSpeed,f=t.clientX,y=t.clientY,d=window.innerWidth,m=window.innerHeight;if(T!==n&&(N=e.scroll,T=n,P=e.scrollFn,!0===N)){N=n;do{if(N.offsetWidth<N.scrollWidth||N.offsetHeight<N.scrollHeight)break}while(N=N.parentNode)}N&&(r=N,a=N.getBoundingClientRect(),i=(nt(a.right-f)<=u)-(nt(a.left-f)<=u),o=(nt(a.bottom-y)<=u)-(nt(a.top-y)<=u)),i||o||(o=(m-y<=u)-(y<=u),((i=(d-f<=u)-(f<=u))||o)&&(r=G)),F.vx===i&&F.vy===o&&F.el===r||(F.el=r,F.vx=i,F.vy=o,clearInterval(F.pid),r&&(F.pid=setInterval((function(){if(s=o?o*p:0,l=i?i*p:0,"function"==typeof P)return P.call(c,l,s,t);r===G?G.scrollTo(G.pageXOffset+l,G.pageYOffset+s):(r.scrollTop+=s,r.scrollLeft+=l)}),24)))}}),30),lt=function(t){function e(t,e){return void 0!==t&&!0!==t||(t=n.name),"function"==typeof t?t:function(n,r){var a=r.options.group.name;return e?t:t&&(t.join?t.indexOf(a)>-1:a==t)}}var n={},r=t.group;r&&"object"==i(r)||(r={name:r}),n.name=r.name,n.checkPull=e(r.pull,!0),n.checkPut=e(r.put),n.revertClone=r.revertClone,t.group=n};try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){K={capture:!1,passive:!1}}}))}catch(t){}return t.prototype={constructor:t,_onTapStart:function(t){var e,r=this,a=this.el,i=this.options,o=i.preventOnFilter,l=t.type,s=t.touches&&t.touches[0],c=(s||t).target,p=t.target.shadowRoot&&t.path&&t.path[0]||c,f=i.filter;if(function(t){at.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var r=e[n];r.checked&&at.push(r)}}(a),!L&&!(/mousedown|pointerdown/.test(l)&&0!==t.button||i.disabled)&&!p.isContentEditable&&(c=n(c,i.draggable,a))&&k!==c){if(e=m(c,i.draggable),"function"==typeof f){if(f.call(this,t,c,this))return u(r,p,"filter",c,a,a,e),void(o&&t.preventDefault())}else if(f&&(f=f.split(",").some((function(t){if(t=n(p,t.trim(),a))return u(r,t,"filter",c,a,a,e),!0}))))return void(o&&t.preventDefault());i.handle&&!n(p,i.handle,a)||this._prepareDragStart(t,s,c,e)}},_prepareDragStart:function(t,e,n,r){var i,o=this,s=o.el,p=o.options,y=s.ownerDocument;n&&!L&&n.parentNode===s&&(W=t,S=s,E=(L=n).parentNode,C=L.nextSibling,k=n,R=p.group,j=r,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,L.style["will-change"]="all",i=function(){o._disableDelayedDrag(),L.draggable=o.nativeDraggable,l(L,p.chosenClass,!0),o._triggerDragStart(t,e),u(o,S,"choose",L,S,S,j)},p.ignore.split(",").forEach((function(t){c(L,t.trim(),f)})),a(y,"mouseup",o._onDrop),a(y,"touchend",o._onDrop),a(y,"touchcancel",o._onDrop),a(y,"selectstart",o),p.supportPointer&&a(y,"pointercancel",o._onDrop),p.delay?(a(y,"mouseup",o._disableDelayedDrag),a(y,"touchend",o._disableDelayedDrag),a(y,"touchcancel",o._disableDelayedDrag),a(y,"mousemove",o._disableDelayedDrag),a(y,"touchmove",o._disableDelayedDrag),p.supportPointer&&a(y,"pointermove",o._disableDelayedDrag),o._dragStartTimer=z(i,p.delay)):i())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),o(t,"mouseup",this._disableDelayedDrag),o(t,"touchend",this._disableDelayedDrag),o(t,"touchcancel",this._disableDelayedDrag),o(t,"mousemove",this._disableDelayedDrag),o(t,"touchmove",this._disableDelayedDrag),o(t,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(t,e){(e=e||("touch"==t.pointerType?t:null))?(W={target:L,clientX:e.clientX,clientY:e.clientY},this._onDragStart(W,"touch")):this.nativeDraggable?(a(L,"dragend",this),a(S,"dragstart",this._onDragStart)):this._onDragStart(W,!0);try{Z.selection?M((function(){Z.selection.empty()})):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(){if(S&&L){var e=this.options;l(L,e.ghostClass,!0),l(L,e.dragClass,!1),t.active=this,u(this,S,"start",L,S,S,j)}else this._nulling()},_emulateDragOver:function(){if(q){if(this._lastX===q.clientX&&this._lastY===q.clientY)return;this._lastX=q.clientX,this._lastY=q.clientY,tt||s(O,"display","none");var t=Z.elementFromPoint(q.clientX,q.clientY),e=t,n=it.length;if(t&&t.shadowRoot&&(e=t=t.shadowRoot.elementFromPoint(q.clientX,q.clientY)),e)do{if(e[X]){for(;n--;)it[n]({clientX:q.clientX,clientY:q.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);tt||s(O,"display","")}},_onTouchMove:function(e){if(W){var n=this.options,r=n.fallbackTolerance,a=n.fallbackOffset,i=e.touches?e.touches[0]:e,o=i.clientX-W.clientX+a.x,l=i.clientY-W.clientY+a.y,c=e.touches?"translate3d("+o+"px,"+l+"px,0)":"translate("+o+"px,"+l+"px)";if(!t.active){if(r&&rt(nt(i.clientX-this._lastX),nt(i.clientY-this._lastY))<r)return;this._dragStarted()}this._appendGhost(),U=!0,q=i,s(O,"webkitTransform",c),s(O,"mozTransform",c),s(O,"msTransform",c),s(O,"transform",c),e.preventDefault()}},_appendGhost:function(){if(!O){var t,e=L.getBoundingClientRect(),n=s(L),r=this.options;l(O=L.cloneNode(!0),r.ghostClass,!1),l(O,r.fallbackClass,!0),l(O,r.dragClass,!0),s(O,"top",e.top-Y(n.marginTop,10)),s(O,"left",e.left-Y(n.marginLeft,10)),s(O,"width",e.width),s(O,"height",e.height),s(O,"opacity","0.8"),s(O,"position","fixed"),s(O,"zIndex","100000"),s(O,"pointerEvents","none"),r.fallbackOnBody&&Z.body.appendChild(O)||S.appendChild(O),t=O.getBoundingClientRect(),s(O,"width",2*e.width-t.width),s(O,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=this,r=t.dataTransfer,i=n.options;n._offUpEvents(),R.checkPull(n,n,L,t)&&((w=b(L)).draggable=!1,w.style["will-change"]="",s(w,"display","none"),l(w,n.options.chosenClass,!1),n._cloneId=M((function(){S.insertBefore(w,L),u(n,S,"clone",L)}))),l(L,i.dragClass,!0),e?("touch"===e?(a(Z,"touchmove",n._onTouchMove),a(Z,"touchend",n._onDrop),a(Z,"touchcancel",n._onDrop),i.supportPointer&&(a(Z,"pointermove",n._onTouchMove),a(Z,"pointerup",n._onDrop))):(a(Z,"mousemove",n._onTouchMove),a(Z,"mouseup",n._onDrop)),n._loopId=setInterval(n._emulateDragOver,50)):(r&&(r.effectAllowed="move",i.setData&&i.setData.call(n,r,L)),a(Z,"drop",n),n._dragStartId=M(n._dragStarted))},_onDragOver:function(r){var a,i,o,l,c=this.el,u=this.options,f=u.group,d=t.active,m=R===f,h=!1,v=u.sort;if(void 0!==r.preventDefault&&(r.preventDefault(),!u.dragoverBubble&&r.stopPropagation()),!L.animated&&(U=!0,d&&!u.disabled&&(m?v||(l=!S.contains(L)):B===this||(d.lastPullMode=R.checkPull(this,d,L,r))&&f.checkPut(this,d,L,r))&&(void 0===r.rootEl||r.rootEl===this.el))){if(ot(r,u,this.el),et)return;if(a=n(r.target,u.draggable,c),i=L.getBoundingClientRect(),B!==this&&(B=this,h=!0),l)return e(d,!0),E=S,void(w||C?S.insertBefore(L,w||C):v||S.appendChild(L));if(0===c.children.length||c.children[0]===O||c===r.target&&function(t,e){var n=t.lastElementChild.getBoundingClientRect();return e.clientY-(n.top+n.height)>5||e.clientX-(n.left+n.width)>5}(c,r)){if(0!==c.children.length&&c.children[0]!==O&&c===r.target&&(a=c.lastElementChild),a){if(a.animated)return;o=a.getBoundingClientRect()}e(d,m),!1!==p(S,c,L,i,a,o,r)&&(L.contains(c)||(c.appendChild(L),E=c),this._animate(i,L),a&&this._animate(o,a))}else if(a&&!a.animated&&a!==L&&void 0!==a.parentNode[X]){x!==a&&(x=a,A=s(a),I=s(a.parentNode));var g=(o=a.getBoundingClientRect()).right-o.left,b=o.bottom-o.top,M=H.test(A.cssFloat+A.display)||"flex"==I.display&&0===I["flex-direction"].indexOf("row"),_=a.offsetWidth>L.offsetWidth,k=a.offsetHeight>L.offsetHeight,N=(M?(r.clientX-o.left)/g:(r.clientY-o.top)/b)>.5,T=a.nextElementSibling,P=!1;if(M){var j=L.offsetTop,D=a.offsetTop;P=j===D?a.previousElementSibling===L&&!_||N&&_:a.previousElementSibling===L||L.previousElementSibling===a?(r.clientY-o.top)/b>.5:D>j}else h||(P=T!==L&&!k||N&&k);var W=p(S,c,L,i,a,o,r,P);!1!==W&&(1!==W&&-1!==W||(P=1===W),et=!0,z(y,30),e(d,m),L.contains(c)||(P&&!T?c.appendChild(L):a.parentNode.insertBefore(L,P?T:a)),E=L.parentNode,this._animate(i,L),this._animate(o,a))}}},_animate:function(t,e){var n=this.options.animation;if(n){var r=e.getBoundingClientRect();1===t.nodeType&&(t=t.getBoundingClientRect()),s(e,"transition","none"),s(e,"transform","translate3d("+(t.left-r.left)+"px,"+(t.top-r.top)+"px,0)"),e.offsetWidth,s(e,"transition","all "+n+"ms"),s(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=z((function(){s(e,"transition",""),s(e,"transform",""),e.animated=!1}),n)}},_offUpEvents:function(){var t=this.el.ownerDocument;o(Z,"touchmove",this._onTouchMove),o(Z,"pointermove",this._onTouchMove),o(t,"mouseup",this._onDrop),o(t,"touchend",this._onDrop),o(t,"pointerup",this._onDrop),o(t,"touchcancel",this._onDrop),o(t,"pointercancel",this._onDrop),o(t,"selectstart",this)},_onDrop:function(e){var n=this.el,r=this.options;clearInterval(this._loopId),clearInterval(F.pid),clearTimeout(this._dragStartTimer),_(this._cloneId),_(this._dragStartId),o(Z,"mouseover",this),o(Z,"mousemove",this._onTouchMove),this.nativeDraggable&&(o(Z,"drop",this),o(n,"dragstart",this._onDragStart)),this._offUpEvents(),e&&(U&&(e.preventDefault(),!r.dropBubble&&e.stopPropagation()),O&&O.parentNode&&O.parentNode.removeChild(O),S!==E&&"clone"===t.active.lastPullMode||w&&w.parentNode&&w.parentNode.removeChild(w),L&&(this.nativeDraggable&&o(L,"dragend",this),f(L),L.style["will-change"]="",l(L,this.options.ghostClass,!1),l(L,this.options.chosenClass,!1),u(this,S,"unchoose",L,E,S,j),S!==E?(D=m(L,r.draggable))>=0&&(u(null,E,"add",L,E,S,j,D),u(this,S,"remove",L,E,S,j,D),u(null,E,"sort",L,E,S,j,D),u(this,S,"sort",L,E,S,j,D)):L.nextSibling!==C&&(D=m(L,r.draggable))>=0&&(u(this,S,"update",L,E,S,j,D),u(this,S,"sort",L,E,S,j,D)),t.active&&(null!=D&&-1!==D||(D=j),u(this,S,"end",L,E,S,j,D),this.save()))),this._nulling()},_nulling:function(){S=L=E=O=C=w=k=N=T=W=q=U=D=x=A=B=R=t.active=null,at.forEach((function(t){t.checked=!0})),at.length=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragover":case"dragenter":L&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.preventDefault()}(t));break;case"mouseover":this._onDrop(t);break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],r=this.el.children,a=0,i=r.length,o=this.options;a<i;a++)n(t=r[a],o.draggable,this.el)&&e.push(t.getAttribute(o.dataIdAttr)||d(t));return e},sort:function(t){var e={},r=this.el;this.toArray().forEach((function(t,a){var i=r.children[a];n(i,this.options.draggable,r)&&(e[t]=i)}),this),t.forEach((function(t){e[t]&&(r.removeChild(e[t]),r.appendChild(e[t]))}))},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return n(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];n[t]=e,"group"===t&&lt(n)},destroy:function(){var t=this.el;t[X]=null,o(t,"mousedown",this._onTapStart),o(t,"touchstart",this._onTapStart),o(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(o(t,"dragover",this),o(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),it.splice(it.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},a(Z,"touchmove",(function(e){t.active&&e.preventDefault()})),t.utils={on:a,off:o,css:s,find:c,is:function(t,e){return!!n(t,e,t)},extend:g,throttle:v,closest:n,toggleClass:l,clone:b,index:m,nextTick:M,cancelNextTick:_},t.create=function(e,n){return new t(e,n)},t.version="1.7.0",t})?r.call(e,n,e,t):r)||(t.exports=a)}()},function(t,e){t.exports='<div id="tool-activelayers">\n\t<div id="toc-activelayers" class="m-toc-activelayers sortable-activelayers">\n\t\t{{#each overlayLayers}}\n\t\t<div id="tocLayer_{{id}}" data-id="{{id}}" class="toc-item-layer">\n\t\t\t<div id="titleTocLayer_{{id}}" class="toc-item-layer-header {{#if outOfRange}}out-of-range{{/if}}{{#if visible}} visible{{/if}}">\n\t\t\t\t<div class="m-area-accion-activelayers-collapse">\n\t\t\t\t\t<button data-id="{{id}}" class="m-accion-activelayers-collapse {{#if collapsed}}g-cartografia-flecha-abajo2{{else}}g-cartografia-flecha-arriba2{{/if}}"\n\t\t\t\t\t title="Opciones de capa"></button>\n\t\t\t\t</div>\n\t\t\t\t<div class="m-area-title">\n\t\t\t\t\t<div id="textTitleLayer_{{id}}" title="{{title}}" class="m-title">{{title}}</div>\n\t\t\t\t\t{{#if canEditName}}\n\t\t\t\t\t<div class="m-button">\n\t\t\t\t\t\t<button data-id="{{id}}" class="m-accion-activelayers-rename g-cartografia-editar" title="Cambiar nombre"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t{{/if}}\n\t\t\t\t</div>\n\t\t\t\t<div class="m-area-activate" title="Activar/Desactivar capa">\n\t\t\t\t\t<input type="checkbox" data-id="{{id}}" class="m-accion-activelayers-activate" {{#if visible}} checked{{/if}}> </input>\n\t\t\t\t\t </div> <div class="m-area-origin">\n\t\t\t\t\t<span>{{origen}}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="m-area-order-hook" title="Orden de capas">\n\t\t\t\t\t<div class="m-accion-activelayers-order">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">\n\t\t\t\t\t\t\t<path d="M25 0c-.254 0-.523.086-.719.281l-7 7a1.005 1.005 0 0 0-.218 1.094c.156.371.535.625.937.625h14.031c.551 0 1-.45 1-1a1.01 1.01 0 0 0-.437-.813L25.719.282A1.015 1.015 0 0 0 25 0zM2 13v4h46v-4zm0 10v4h46v-4zm0 10v4h46v-4zm16 8c-.402 0-.781.25-.938.625-.156.375-.066.809.22 1.094l7 7c.195.195.46.281.718.281.258 0 .523-.086.719-.281l7-7c.285-.285.375-.719.218-1.094A1.023 1.023 0 0 0 32 41z" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id="optionsTocLayer_{{id}}" class="toc-item-layer-options{{#if collapsed}} dNone{{/if}}">\n\t\t\t\t<div class="layer-option-row">\n\t\t\t\t\t<div class="transparency-control">\n\t\t\t\t\t\t<input type="range" data-id="{{id}}" title="Nivel de transparencia" class="m-accion-activelayers-transparency"\n\t\t\t\t\t\t min="0" max="1" step="0.1" value="{{opacity}}" {{#unless visible}} disabled {{/unless}} {{#if outOfRange}}\n\t\t\t\t\t\t disabled{{/if}}/> <span class="transparency-percentage">{{opacityPer}}%</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t{{#gt styles.length 1}}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<button data-id="{{id}}" class="m-accion-activelayers-showstyles g-cartografia-lista" title="Estilos de la capa"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t{{/gt}} {{#if metadata}}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<button data-id="{{id}}" class="m-accion-activelayers-metadata g-cartografia-texto" title="Ver metadatos"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t{{/if}} {{#if infoLayer}}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<button data-id="{{id}}" class="m-accion-activelayers-info g-cartografia-info" title="Información de la capa"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t{{/if}}\n\t\t\t\t\t{{#if canRemove}}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t\x3c!-- <span data-id="{{id}}" class="m-accion-activelayers-remove g-cartografia-papelera"></span> --\x3e\n\t\t\t\t\t\t<button data-id="{{id}}" class="m-accion-activelayers-remove g-cartografia-papelera" title="Eliminar capa"></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t{{/if}}\n\t\t\t\t</div>\n\t\t\t\t<div class="layer-option-row">\n\t\t\t\t\t<div class="legend">\n\t\t\t\t\t\t<h3>Leyenda</h3>\n\t\t\t\t\t\t<img data-id="{{id}}" src="{{legend}}"></img>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="layer-option-row">\n\t\t\t\t\t<div id="stylesTocLayer_{{id}}" class="{{#unless showStyles}}dNone{{/unless}}">\n\t\t\t\t\t\t<h3>Estilos de capa</h3>\n\t\t\t\t\t\t{{#each styles}}\n\t\t\t\t\t\t<div class="m-accion-activelayers-styles">\n\t\t\t\t\t\t\t<input id="{{@index}}-{{id}}" data-id="{{id}}" type="radio" class="m-accion-activelayers-activestyle"\n\t\t\t\t\t\t\t {{#if selected}} checked{{/if}} name="{{id}}" value="{{@index}}" />\n\t\t\t\t\t\t\t<label for="{{@index}}-{{id}}">{{Title}}</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{{/each}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t</div>\n\t\t{{else}}\n\t\t<div class="info">\n\t\t\t<span>No existe ninguna capa activa</span>\n\t\t</div>\n\t\t{{/each}}\n\t</div>\n</div>'},function(t,e){t.exports='<div id="tool-baselayers">\n\t<div id="toc-baselayers" class="m-toc-baselayers">\n\t\t{{#if baseMapBlanco}}\n\t\t<div id="{{baseMapBlanco.id}}" data-id="{{baseMapBlanco.id}}" class="box m-accion-baselayers-load {{#if activo}} baseActivo{{/if}}">\n\t\t\t<img data-id="{{baseMapBlanco.id}}" class="m-accion-baselayers-load">\n\t\t\t<div class="caption simple-caption">\n\t\t\t\t<h5 data-id="{{baseMapBlanco.id}}" class="m-accion-baselayers-load">Fondo Blanco</h5>\n\t\t\t</div>\n\t\t</div>\n\t\t{{/if}} {{#gt baseLayers.length 0}} {{#each baseLayers}}\n\t\t<div id="{{id}}" class="box{{#if activo}} baseActivo{{/if}}">\n\t\t\t<img data-id="{{id}}" class="m-accion-baselayers-load" src="{{img}}" alt="{{descripcion}}">\n\t\t\t<div class="caption simple-caption">\n\t\t\t\t<h5 data-id="{{id}}" class="m-accion-baselayers-load">{{title}}</h5>\n\t\t\t</div>\n\t\t</div>\n\t\t{{/each}} {{/gt}}\n\t</div>\n</div>'},function(t){t.exports=JSON.parse('{"url":{"name":"managelayers","separator":"*"},"constructor":"M.plugin.ManageLayers","parameters":[{}],"files":{"ol":{"scripts":["managelayers.ol.min.js"],"styles":["managelayers.ol.min.css"]}},"metadata":{"name":"ManageLayers","description":"TOC personalizable","text":"TOC personalizable con secciones para capas activas, de fondo y favoritas.","version":"1.0.1","date":"Marzo, 2022","author":"","org":"Instituto de Estadística y Cartografía. Junta de Andalucía","tags":"mapea,plugin","icon":"./facade/assets/icons/icons.svg","centralized":false,"compatibility":["5","6"]}}')},function(t,e){t.exports='<div id="tool-thematiclayers">\n\t<div id="toc-thematiclayers" class="m-toc-thematiclayers">\n\t\t{{#gt groups.length 0}} {{#each groups}}\n\t\t<div id="tocGroup_{{id}}" data-id="{{id}}" class="toc-item-group">\n\t\t\t<div class="toc-item-group-header">\n\t\t\t\t<div class="layer-group-name">\n\t\t\t\t\t<button data-id="{{id}}" class="m-accion-thematiclayers-collapse {{#if collapsed}}g-cartografia-flecha-abajo2{{else}}g-cartografia-flecha-arriba2{{/if}}"\n\t\t\t\t\t title="Lista de capas"></button>\n\t\t\t\t\t<span>{{title}}</span>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- <div class="layer-group-button">\n\t\t\t\t\t<button data-id="{{id}}" class="m-accion-thematiclayers-load-group {{#if activated}}g-cartografia-cancelar2{{else}}g-cartografia-mas2{{/if}}"\n\t\t\t\t\t title="{{#if activated}}Eliminar todas las capas del grupo{{else}}Añadir todas las capas del grupo{{/if}}"></button>\n\t\t\t\t</div> --\x3e\n\t\t\t</div>\n\t\t\t<div id="optionsTocGroup_{{id}}" class="toc-item-group-options{{#if collapsed}} dNone{{/if}}">\n\t\t\t\t{{#gt overlays.length 0}} {{#each overlays}}\n\t\t\t\t<div class="toc-item-group-overlay">\n\t\t\t\t\t<input id="{{@index}}-{{id}}" class="m-accion-thematiclayers-load" type="checkbox" data-id="{{id}}" value="{{id}}" title="Añadir/Eliminar capa"\n\t\t\t\t\t {{#if load}}checked{{/if}}>\n\t\t\t\t\t<label for="{{@index}}-{{id}}">{{title}}</label>\n\t\t\t\t</div>\n\t\t\t\t{{/each}} {{/gt}}\n\t\t\t</div>\n\t\t</div>\n\t\t{{/each}} {{/gt}}\n\t</div>\n</div>'},function(t,e){t.exports='<div id="toolbar-managelayers" class="m-control m-toolbar m-control-toolbar-managelayers">\n\t\x3c!-- TOOLBARS BUTTONS --\x3e\n\t<div id="toolbar-buttons-managelayers" class="m-toolbar-buttons m-toolbar-buttons-managelayers"></div>\n\t\x3c!-- TITLE --\x3e\n\t<div id="toolbar-title-managelayers" class="title">Gestión de capas</div>\n\n\t<div id="toolbar-containers-managelayers" class="m-toolbar-containers m-toolbar-containers-managelayers">\n\t\t<div id="m-waiting-result" class="dNone m-waiting-result g-cartografia-spinner"></div>\n\t</div>\n</div>'},function(t,e){t.exports='<div id="tool-wmclayers">\n\t<div id="toc-wmclayers" class="m-toc-wmclayers">\n\t\t{{#gt wmcLayers.length 0}}\n\t\t<div class="toc-item-group-header">\n\t\t\t<div class="layer-group-name">\n\t\t\t\t<span>Capas WMC: {{name}}</span>\n\t\t\t</div>\n\t\t\t<div class="layer-group-button">\n\t\t\t\t\x3c!-- <button data-id="{{id}}" class="m-accion-thematiclayers-load-group {{#if activated}}g-cartografia-cancelar2{{else}}g-cartografia-mas2{{/if}}"\n\t\t\t\t title="{{#if activated}}Eliminar todas las capas del grupo{{else}}Añadir todas las capas del grupo{{/if}}"></button> --\x3e\n\t\t\t\t<button class="m-accion-wmclayers-load-group g-cartografia-mas2" title="Añadir todas las capas"></button>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!-- <div class="title">\n\t\t\t<span>Capas WMC: {{name}}</span>\n\t\t\t<button class="m-accion-wmclayers-load-group g-cartografia-mas2" title="Añadir todas las capas"></button>\n\t\t</div> --\x3e\n\t\t{{#each wmcLayers}}\n\t\t<div id="wmclayer_{{id}}" class="toc-item-layer">\n\t\t\t<input id="{{@index}}-{{id}}" class="m-accion-wmclayers-load" type="checkbox" data-id="{{id}}" value="{{id}}" {{#if load}}checked{{/if}}\n\t\t\t title="Añadir/Eliminar capa">\n\t\t\t<label for="{{@index}}-{{id}}">{{title}}</label>\n\t\t</div>\n\t\t{{/each}} {{else}}\n\t\t<div class="info">\n\t\t\t<span>No se ha añadido ninguna capa WMC</span>\n\t\t</div>\n\t\t{{/gt}}\n\t</div>\n</div>'},function(t,e,n){},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=o(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}}).apply(this,arguments)}function o(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=u(t);if(e){var a=u(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.r(e);var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}(c,M.impl.Control);var e,n,r,o=s(c);function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=o.call(this)).params_=t||{},e.facadeMap_=null,e}return e=c,(n=[{key:"addTo",value:function(t,e){this.facadeMap_=t,this.element=e,i(u(c.prototype),"addTo",this).call(this,t,e)}},{key:"activate",value:function(){}},{key:"deactivate",value:function(){}},{key:"destroy",value:function(){this.deactivate(),this.element.remove(),this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null,this.element=null}}])&&a(e.prototype,n),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(),f=n(0),y=n.n(f);function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=v(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}}).apply(this,arguments)}function v(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L(t);if(e){var a=L(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _(this,n)}}function _(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(i,M.Control);var e,n,r,a=b(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(p)&&M.exception("La implementación usada no puede crear controles ManageLayersControl"),(r=a.call(this,t,n.controlName)).params_=e||{},r.options_=r.getControlOptions_(n),r}return e=i,r=[{key:"NAME",get:function(){return"ManageLayers"}},{key:"CONFIG_BASE",get:function(){return{controlName:i.NAME,template:y.a,iconClass:"g-cartografia-capas2",tooltip:"Gestor capas"}}}],(n=[{key:"createView",value:function(t){var e=this;return new Promise((function(t,n){var r=M.template.compileSync(e.options_.template,{vars:e.options_}),a=null;if(M.utils.isNullOrEmpty(e.options_.toolbar))a=r,e.getPanel()._controlsContainer.appendChild(r);else{var i=e.options_.toolbar;!1==!M.utils.isNullOrEmpty(e.getPanel()._element.querySelector(i.selector))&&e.getPanel()._controlsContainer.appendChild(i.target);var o=r.querySelector(e.getSelectorToolbarButton_()),l=r.querySelector(e.getSelectorToolbarContainer_());i.target.querySelector(i.selectorBtn).appendChild(o),i.target.querySelector(i.selectorContainer).appendChild(l),a=i.target}e.addEvents(a),t(a)}))}},{key:"activate",value:function(){this.getToolbarContainer_().classList.toggle("dNone"),this.getControlButton_().classList.toggle("active"),this.getTitleControlManageLayers_().innerText=this.options_.tooltip,h(L(i.prototype),"activate",this).call(this)}},{key:"deactivate",value:function(){this.getToolbarContainer_().classList.toggle("dNone"),this.getControlButton_().classList.toggle("active"),h(L(i.prototype),"deactivate",this).call(this)}},{key:"getControlOptions_",value:function(t){t=t||{};var e=M.utils.extend({},i.CONFIG_BASE,!0);return(e=M.utils.extend(e,t,!0)).baseName=M.utils.isNullOrEmpty(e.baseName)?e.controlName:e.baseName,e.baseName=e.baseName.toLowerCase(),e}},{key:"getConfigDefault_",value:function(){return this.CONFIG_BASE}},{key:"addEvents",value:function(t){}},{key:"render",value:function(){}},{key:"getActivationButton",value:function(t){return t.querySelector(this.getSelectorButton_())}},{key:"equals",value:function(t){var e=!1;return t instanceof i&&(e=this.name===t.name),e}},{key:"getSelectorToolbarButton_",value:function(){return"#toolbar-button-"+this.options_.baseName}},{key:"getSelectorToolbarContainer_",value:function(){return"#toolbar-container-"+this.options_.baseName}},{key:"getSelectorButton_",value:function(){return"#tool-btn-"+this.options_.baseName}},{key:"getSelectorContainer_",value:function(){return"#tool-"+this.options_.baseName}},{key:"getToolbarContainer_",value:function(){return this.getPanel()._element.querySelector(this.getSelectorToolbarContainer_())}},{key:"getControlContainer_",value:function(){return this.getPanel()._element.querySelector(this.getSelectorContainer_())}},{key:"getControlButton_",value:function(){return this.getPanel()._element.querySelector(this.getSelectorButton_())}},{key:"getTitleControlManageLayers_",value:function(){return this.getPanel()._element.querySelector("#toolbar-title-managelayers")}},{key:"getOptionsControlManageLayers",value:function(t){return this.getOptionsManageLayers(t,this.name.toLowerCase())}},{key:"setOptionsControlManageLayers",value:function(t,e){this.setOptionsManageLayers(t,e,this.name.toLowerCase())}},{key:"getOptionsManageLayers",value:function(t,e){var n=t.options.manageLayers;return M.utils.isNullOrEmpty(e)||M.utils.isNullOrEmpty(n)||(n=n[e]),n}},{key:"setOptionsManageLayers",value:function(t,e,n){M.utils.isNullOrEmpty(t.options.manageLayers)&&(t.options.manageLayers={}),M.utils.isNullOrEmpty(n)?t.options.manageLayers=e:t.options.manageLayers[n]=e}},{key:"resetOptionsManageLayers",value:function(t){t.options.manageLayers={}}},{key:"getQuerySelectorScapeCSS",value:function(t,e,n){return t.querySelector(e+CSS.escape(n))}},{key:"activateLoading",value:function(){this.getPanel()._element.querySelector("#m-waiting-result").classList.remove("dNone"),this.getPanel()._element.querySelector(".m-toolbar-containers-managelayers").style.minHeight="70px"}},{key:"deactivateLoading",value:function(){this.getPanel()._element.querySelector("#m-waiting-result").classList.add("dNone"),this.getPanel()._element.querySelector(".m-toolbar-containers-managelayers").style.minHeight="initial"}},{key:"addLayers",value:function(t){this.map_.addLayers(t)}},{key:"removeLayers",value:function(t){this.map_.getImpl().removeItemLayers(t)}},{key:"isLoadLayer",value:function(t){var e=!1;return null!=this.findLayerById(t.id)&&(e=!0),e}},{key:"findLayerByName",value:function(t){return this.findItemByProperty(this.map_.getLayers(),"name",t)}},{key:"findLayerById",value:function(t){return this.findItemByProperty(this.map_.getLayers(),"id",t)}},{key:"findItemByProperty",value:function(t,e,n){var r=null;return t&&e&&t.some((function(t){if(t[e]===n)return r=t,!0})),r}}])&&m(e.prototype,n),r&&m(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}();function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=N(t);if(e){var a=N(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return k(this,n)}}function k(t,e){if(e&&("object"===O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function N(t){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}(i,M.impl.Control);var e,n,r,a=C(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this)).params_=t||{},e.facadeMap_=null,e.totalActiveLayers_=0,e}return e=i,(n=[{key:"addTo",value:function(t,e){this.facadeMap_=t,this.element=e;var n=t.getMapImpl();ol.control.Control.call(this,{element:e,target:null}),n.addControl(this)}},{key:"activate",value:function(){this.registerEvents()}},{key:"deactivate",value:function(){this.unregisterEvents()}},{key:"destroy",value:function(){this.deactivate(),this.element.remove(),this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null,this.element=null}},{key:"registerEvents",value:function(){var t=this;if(!M.utils.isNullOrEmpty(this.facadeMap_)){var e=this.facadeMap_.getMapImpl();this.registerViewEvents_(e.getView()),this.registerLayersEvents_(e.getLayers()),e.on("change:view",(function(e){return t.onViewChange_(e)}))}}},{key:"unregisterEvents",value:function(){var t=this;if(!M.utils.isNullOrEmpty(this.facadeMap_)){var e=this.facadeMap_.getMapImpl();this.unregisterViewEvents_(e.getView()),this.unregisterLayersEvents_(e.getLayers()),e.un("change:view",(function(e){return t.onViewChange_(e)}))}}},{key:"registerViewEvents_",value:function(t){var e=this;t.on("change:resolution",(function(){return e.renderPanel()}))}},{key:"registerLayersEvents_",value:function(t){var e=this;t.forEach((function(t){return e.registerLayerEvents_(t)})),t.on("remove",(function(){return e.renderPanel()})),t.on("add",(function(t){return e.onAddLayer_(t)}))}},{key:"registerLayerEvents_",value:function(t){var e=this;t.on("change:visible",(function(){return e.renderPanel()})),t.on("change:extent",(function(){return e.renderPanel()}))}},{key:"unregisterViewEvents_",value:function(t){var e=this;t.un("change:resolution",(function(){return e.renderPanel()}))}},{key:"unregisterLayersEvents_",value:function(t){var e=this;t.forEach((function(t){return e.registerLayerEvents_(t)})),t.un("remove",(function(){return e.renderPanel()})),t.un("add",(function(t){return e.onAddLayer_(t)}))}},{key:"unregisterLayerEvents_",value:function(t){var e=this;t.un("change:visible",(function(){return e.renderPanel()})),t.un("change:extent",(function(){return e.renderPanel()}))}},{key:"onViewChange_",value:function(t){this.unregisterViewEvents_(t.oldValue);var e=this.facadeMap_.getMapImpl();this.registerViewEvents_(e.getView())}},{key:"onAddLayer_",value:function(t){var e=t.element;this.registerLayerEvents_(e),e.setZIndex(this.totalActiveLayers_+1),this.renderPanel()}},{key:"renderPanel",value:function(t){this.facadeCtrol_.renderPanel()}},{key:"moveLayer",value:function(t,e,n){var r=this.getFilterLayerList(!1),a=n-e;if(a>0){for(var i=a;i>0;i--)r[n+1-i].setZIndex(r[n+1-i].getZIndex()+1);r[e].setZIndex(r[e].getZIndex()-a)}else{a*=-1;for(var o=1;o<=a;o++)r[n-1+o].setZIndex(r[n-1+o].getZIndex()-1);r[e].setZIndex(r[e].getZIndex()+a)}}},{key:"updateOrderLayer",value:function(t,e){t.setZIndex(e)}},{key:"getFilterLayerList",value:function(t){var e=this,n=this.facadeMap_.getLayers().filter((function(t){var n=!0===t.isBaseMap,r="__draw__"===t.name,a=!0===t.transparent,i=!0===t.displayInLayerSwitcher,o=t.type!==M.layer.type.WMC,l=!(t.type===M.layer.type.WMS&&M.utils.isNullOrEmpty(t.name));return n?e.updateOrderLayer(t,0):o&&!r&&(!1===a?e.updateOrderLayer(t,1):!1===i&&e.updateOrderLayer(t,2)),!n&&!r&&a&&o&&l&&i})).sort((function(e,n){var r=e.getZIndex(),a=n.getZIndex();if(isNaN(r)&&isNaN(a))return 0;if(isNaN(r))return-1;if(isNaN(a))return 1;var i=r-a;return t?i:-i})).map((function(e,n,r){return t?e.setZIndex(n+3):e.setZIndex(r.length+2-n),e}));return this.totalActiveLayers_=n.length,n}},{key:"setLayerStyle",value:function(t,e){t.getImpl().setSelectedStyle(e)}},{key:"getMetadataLink",value:function(t){return t.getImpl().getMetadataURL()}},{key:"getStylesLayer",value:function(t){return t.getImpl().getStylesLayer()}},{key:"getLayerStylePosition",value:function(t){return t.getImpl().selectedStyle_}}])&&w(e.prototype,n),r&&w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(),P=n(1),x=n.n(P),A=n(2),I=n.n(A);function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function B(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=U(t);if(e){var a=U(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return W(this,n)}}function W(t,e){if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return q(t)}function q(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var F=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(i,t);var e,n,r,a=B(i);function i(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(T)&&M.exception("La implementación usada no puede crear controles ActiveLayersControl");var r={controlName:i.NAME,iconClass:"g-cartografia-capas2",tooltip:"Capas activas"};e=M.utils.extend(r,e,!0);var o=new T(t);return(n=a.call(this,o,t,e)).params_=t||{},o.facadeCtrol_=q(n),n.countID_=0,n.boundClickLayer_=function(t){return n.clickLayer(t)},n}return e=i,r=[{key:"NAME",get:function(){return"ActiveLayers"}},{key:"TEMPLATE",get:function(){return I.a}}],(n=[{key:"addEvents",value:function(t){var e=this;t.querySelector(this.getSelectorContainer_()).addEventListener("input",(function(t){return e.clickLayerSlider(t)}))}},{key:"clickLayerSlider",value:function(t){if(t=t||window.event,!M.utils.isNullOrEmpty(t.target)){var e=t.target,n=e.getAttribute("data-id");if(!M.utils.isNullOrEmpty(n)){var r=this.findLayerById(n);e.classList.contains("m-accion-activelayers-transparency")&&(r.setOpacity(parseFloat(e.value)),e.nextElementSibling.innerHTML=100*e.value+"%")}}}},{key:"clickLayer",value:function(t){if(t=t||window.event,!M.utils.isNullOrEmpty(t.target)){var e=t.target,n=e.getAttribute("data-id");if(!M.utils.isNullOrEmpty(n)){var r=this.findLayerById(n),a=this.getControlContainer_(),i=this.getQuerySelectorScapeCSS(a,"#optionsTocLayer_",n);if(e.classList.contains("m-accion-activelayers-collapse"))this.getOptionsControlManageLayers(r).collapsed=!i.classList.contains("dNone"),i.classList.toggle("dNone"),e.classList.toggle("g-cartografia-flecha-abajo2"),e.classList.toggle("g-cartografia-flecha-arriba2");else if(e.classList.contains("m-accion-activelayers-rename")){var o=this.getQuerySelectorScapeCSS(a,"#textTitleLayer_",n),l=document.createElement("input");l.type="text",l.value=o.innerText,o.innerText="",o.appendChild(l),l.addEventListener("focus",(function(){this.select()})),l.focus(),l.addEventListener("blur",(function(t){return function t(e){o.innerHTML=l.value,r.legend=l.value,l.removeEventListener("blur",(function(e){return t()})),l=null}()}))}else if(e.classList.contains("m-accion-activelayers-activate")){if(!0===r.transparent||!r.isVisible()){var s=e.parentElement.parentElement.querySelector("div.tools > input");M.utils.isNullOrEmpty(s)||r.setOpacity(s.value),r.setVisible(!r.isVisible())}}else if(e.classList.contains("m-accion-activelayers-metadata"))r.type!==M.layer.type.WMS&&r.type!==M.layer.type.WFS||this.getImpl().getMetadataLink(r).then((function(t){window.open(t,"_blank")}));else if(e.classList.contains("m-accion-activelayers-info"))r.getImpl().getAbstractLayer().then((function(t){var e="Información: "+r.legend;M.utils.isNullOrEmpty(t)&&(t="No hay descripción asociada a la capa"),M.dialog.info(t,e)}));else if(e.classList.contains("m-accion-activelayers-showstyles")){var c=this.getQuerySelectorScapeCSS(a,"#stylesTocLayer_",n);this.getOptionsControlManageLayers(r).showStyles=c.classList.contains("dNone"),c.classList.toggle("dNone")}else if(e.classList.contains("m-accion-activelayers-activestyle")){var u=e.value;u!=this.getImpl().getLayerStylePosition(r)&&(this.getImpl().setLayerStyle(r,u),this.renderPanel())}else e.classList.contains("m-accion-activelayers-remove")&&(this.resetOptionsManageLayers(r),this.removeLayers(r))}}}},{key:"moveLayer",value:function(t,e,n){var r=M.utils.isNullOrEmpty(t)?"":t.getAttribute("data-id");M.utils.isNullOrEmpty(r)||this.getImpl().moveLayer(r,e,n)}},{key:"render",value:function(){this.renderPanel()}},{key:"renderPanel",value:function(){var t=this;this.activateLoading(),this.getTemplateVariables_().then((function(e){var n=M.template.compileSync(i.TEMPLATE,{vars:{overlayLayers:e}});t.sortableList&&(t.sortableList.destroy(),t.sortableList=null);var r=t.getControlContainer_().querySelectorAll("[class^=m-accion-]");if(Array.from(r).forEach((function(e){e.removeEventListener("click",t.boundClickLayer_)})),t.registerImgErrorEvents_(n),t.getControlContainer_().innerHTML=n.innerHTML,!t.sortableList){var a=t.getControlContainer_().querySelector(".sortable-activelayers");t.sortableList=x.a.create(a,{animation:150,handle:".m-accion-activelayers-order",onEnd:function(e){t.moveLayer(e.item,e.oldIndex,e.newIndex)}})}r=t.getControlContainer_().querySelectorAll("[class^=m-accion-]"),Array.from(r).forEach((function(e){e.addEventListener("click",t.boundClickLayer_)})),t.deactivateLoading()}))}},{key:"getTemplateVariables_",value:function(){var t=this;this.setConfigLayers();var e=this.getImpl().getFilterLayerList(!1).map((function(e){return t.parseLayerForTemplate_(e)}));return Promise.all(e).catch((function(t){return console.log("Catch",t)}))}},{key:"parseLayerForTemplate_",value:function(t,e){var n=this;return new Promise((function(r,a){var i=n.getOptionsControlManageLayers(t);M.utils.isNullOrEmpty(i)&&(i={index:e,collapsed:!0,showStyles:!1},n.setOptionsControlManageLayers(t,i));var o=t.legend;M.utils.isNullOrEmpty(o)&&(o=t.name),M.utils.isNullOrEmpty(o)&&(o="Servicio - "+t.type);var l=t.options.metadata,s=t.type===M.layer.type.WMS||t.type===M.layer.type.WMTS||t.type===M.layer.type.WFS,c={metadata:!M.utils.isNullOrEmpty(l),infoLayer:s,origen:t.options.origen,collapsed:!0===i.collapsed,showStyles:!0===i.showStyles,base:!1===t.transparent,visible:!0===t.isVisible(),id:t.id,name:t.name,title:o,legend:t.getLegendURL(),outOfRange:!t.inRange(),opacity:t.getOpacity(),opacityPer:100*t.getOpacity(),styles:[],canEditName:"Inicial"!=t.options.origen&&"Tematica"!=t.options.origen,canRemove:"Inicial"!=t.options.origen},u=[];(t.type===M.layer.type.WMS||t.type===M.layer.type.WFS&&M.utils.isNullOrEmpty(l))&&u.push(n.getImpl().getMetadataLink(t).then((function(t){c.metadata=t})).catch((function(t){return console.log("Catch",t)}))),t.type===M.layer.type.WMS&&u.push(n.getImpl().getStylesLayer(t).then((function(e){var r=n.getImpl().getLayerStylePosition(t);c.styles=e.map((function(e,n){return e.id=t.id,e.selected=r==n,e})),c.legend=t.getLegendURL()})).catch((function(t){return console.log("Catch",t)}))),Promise.all(u).then((function(){r(c)})).catch((function(t){return console.log("Catch",t)}))}))}},{key:"registerImgErrorEvents_",value:function(t){var e=this,n=t.querySelectorAll("img");Array.prototype.forEach.call(n,(function(t){t.addEventListener("error",(function(t){var n=t.target.getAttribute("data-id"),r=e.findLayerById(n),a=M.utils.concatUrlPaths([M.config.THEME_URL,M.Layer.LEGEND_ERROR]);M.utils.isNullOrEmpty(r)||(r.setLegendURL(a),t.target.src=a)}))}))}},{key:"equals",value:function(t){var e=!1;return t instanceof i&&(e=this.name===t.name),e}},{key:"setConfigLayers",value:function(){var t=this;this.map_.getLayers().forEach((function(e,n){M.utils.isUndefined(e.options)&&(e.options={}),M.utils.isNullOrEmpty(e.id)&&(e.id=t.countID_+++"_"+e.name),M.utils.isNullOrEmpty(e.options.origen)&&(e.options.origen="Inicial"),M.utils.isNullOrEmpty(e.options.urlLegend)||e.setLegendURL(e.options.urlLegend)}))}}])&&D(e.prototype,n),r&&D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(E);function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function G(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Y(t);if(e){var a=Y(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Z(this,n)}}function Z(t,e){if(e&&("object"===V(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X(t,e)}(i,M.impl.Control);var e,n,r,a=G(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this)).params_=t||{},e.facadeMap_=null,e}return e=i,(n=[{key:"addTo",value:function(t,e){this.facadeMap_=t,this.element=e;var n=t.getMapImpl();ol.control.Control.call(this,{element:e,target:null}),n.addControl(this)}},{key:"destroy",value:function(){this.deactivate(),this.element.remove(),this.facadeMap_.getMapImpl().removeControl(this),this.facadeMap_=null,this.element=null}}])&&H(e.prototype,n),r&&H(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(),Q=n(3),J=n.n(Q);function K(t){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t){return function(t){if(Array.isArray(t))return et(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||tt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t,e){if(t){if("string"==typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rt(){return(rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=at(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}}).apply(this,arguments)}function at(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=st(t)););return t}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=st(t);if(e){var a=st(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return lt(this,n)}}function lt(t,e){if(e&&("object"===K(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ct=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&it(t,e)}(i,t);var e,n,r,a=ot(i);function i(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),M.utils.isUndefined(z)&&M.exception("La implementación usada no puede crear controles BaseLayersControl");var r={controlName:i.NAME,iconClass:"g-cartografia-localizacion",tooltip:"Mapas base"};e=M.utils.extend(r,e,!0);var o=new z;return(n=a.call(this,o,t,e)).params_=t||{},n.map_=null,n.baseMaps_=[],n.mapaActivo=null,n.activatedBlankMap=null,n}return e=i,r=[{key:"NAME",get:function(){return"BaseLayers"}},{key:"TEMPLATE",get:function(){return J.a}},{key:"BASEMAP_BLANCO",get:function(){return"base_blanco"}},{key:"IMG_BASEMAP_DEFAULT",get:function(){return"assets/img/default.png"}},{key:"IMG_BASEMAP_WHITE",get:function(){return"assets/img/osm.png"}}],(n=[{key:"addTo",value:function(t){rt(st(i.prototype),"addTo",this).call(this,t),this.map_=t,this.baseMaps_=this.loadConfigInicial(),this.activatedBlankMap=!!M.utils.isNullOrEmpty(this.params_.activatedBlankMap)||this.params_.activatedBlankMap,M.utils.isNullOrEmpty(this.mapaActivo)&&this.activatedBlankMap&&(this.mapaActivo=i.BASEMAP_BLANCO),this.renderPanel()}},{key:"render",value:function(){}},{key:"renderPanel",value:function(){var t=this.getTemplateVariables_(),e=M.template.compileSync(i.TEMPLATE,{vars:t});this.getControlContainer_().innerHTML=e.innerHTML}},{key:"getTemplateVariables_",value:function(){var t={baseLayers:this.baseMaps_.map(this.parseLayerForTemplate_,this)};return this.activatedBlankMap&&(t.baseMapBlanco={id:i.BASEMAP_BLANCO,activo:i.BASEMAP_BLANCO==this.mapaActivo}),t}},{key:"parseLayerForTemplate_",value:function(t){var e=t.layer,n=e.legend;M.utils.isNullOrEmpty(n)&&(n=e.name),M.utils.isNullOrEmpty(n)&&(n="Mapa base");var r=e.options.descripcion;M.utils.isNullOrEmpty(r)&&(r="Imagen mapa base - "+n);var a=t.img,i=this.mapaActivo===t.id;return{id:t.id,title:n,descripcion:r,img:a,activo:i}}},{key:"addEvents",value:function(t){var e=this;t.querySelector(this.getSelectorContainer_()).addEventListener("click",(function(t){return e.clickBaseLayer(t)})),this.map_.on(M.evt.CHANGE_WMC,(function(){e.mapaActivo=null,e.baseMaps_=e.loadConfigInicial(),e.renderPanel()}))}},{key:"clickBaseLayer",value:function(t){var e=(t=t||window.event).target;if(!M.utils.isNullOrEmpty(e)&&e.classList.contains("m-accion-baselayers-load")){t.stopPropagation();var n=e.getAttribute("data-id");if(!M.utils.isNullOrEmpty(n)){var r=this.getControlContainer_().querySelector(".baseActivo"),a=r?r.getAttribute("id"):null;if(n!=a){this.getControlContainer_().querySelector("#"+n).classList.toggle("baseActivo");try{var i=this.findItemByProperty(this.baseMaps_,"id",n);i&&i.layer&&i.layer.getImpl().getOL3Layer().setVisible(!0)}catch(t){}try{a&&(r.classList.toggle("baseActivo"),this.findItemByProperty(this.baseMaps_,"id",a).layer.getImpl().getOL3Layer().setVisible(!1))}catch(t){}}}}}},{key:"loadConfigInicial",value:function(){var t=this,e=this.params_.baseMaps,n=!1,r=this.map_.getBaseLayers().map((function(t){return{img:"",layer:t}}));if(r.length){for(var a=0;a<r.length;a++)r[a].layer.isVisible()&&!n?(r[a].activo=!0,n=!0):r[a].activo=!1;var i,o=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=tt(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}(e);try{for(o.s();!(i=o.n()).done;)i.value.activo=!1}catch(t){o.e(t)}finally{o.f()}n||(r[0].layer.setVisible(!0),r[0].activo=!0,n=!0),e=[].concat($(e),$(r))}return M.utils.isNullOrEmpty(e)&&(e=[]),M.utils.isArray(e)||(e=[e]),e.map((function(e,r){var a;if(e.layer.setZIndex(0),e.id="base_"+r,!0===e.activo&&M.utils.isNullOrEmpty(t.mapaActivo)&&(t.mapaActivo=e.id,n||t.addLayers(e.layer)),M.utils.isNullOrEmpty(e.img)&&(e.img=t.getImgLayer(e.layer)),e.layer instanceof M.Layer)a=e.layer;else try{var i=M.parameter.layer(e.layer);M.utils.isNullOrEmpty(i.type)?M.dialog.error("No se ha especificado un tipo válido para la capa"):a=new M.layer[i.type](e.layer)}catch(t){M.dialog.error("El formato de la capa ("+e.layer+") no se reconoce")}return M.utils.isNullOrEmpty(a.id)&&(a.id=e.id),a.isbaseLayer=!0,a.transparent=!1,M.utils.isUndefined(a.options)&&(a.options={}),a.options.queryable=!1,e.layer=a,e}))}},{key:"equals",value:function(t){var e=!1;return t instanceof i&&(e=this.name===t.name),e}},{key:"getImgLayer",value:function(t){if(t.type===M.layer.type.WMS){var e=t.getLegendURL();return e||t.url+(t.url.indexOf("?")>-1?"&":"?")+"service=WMS&request=GetMap&layers="+t.name+"&bbox="+this.map_.getMaxExtent()+"&width=200&height=120&version=1.1.1&srs="+this.map_.getProjection().code+"&format=image/png"}return i.IMG_BASEMAP_DEFAULT}}])&&nt(e.prototype,n),r&&nt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(E),ut=(n(8),n(4));function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ft=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"initMapeaCoreExtension",value:function(t){if(M.utils.isNullOrEmpty(t.fnEquals_)){t.fnEquals_=[],t.fnEquals_[M.layer.type.GeoJSON]=M.layer.GeoJSON.prototype.equals,t.fnEquals_[M.layer.type.KML]=M.layer.KML.prototype.equals,t.fnEquals_[M.layer.type.Mapbox]=M.layer.Mapbox.prototype.equals,t.fnEquals_[M.layer.type.OSM]=M.layer.OSM.prototype.equals,t.fnEquals_[M.layer.type.WFS]=M.layer.WFS.prototype.equals,t.fnEquals_[M.layer.type.WMC]=M.layer.WMC.prototype.equals,t.fnEquals_[M.layer.type.WMS]=M.layer.WMS.prototype.equals,t.fnEquals_[M.layer.type.WMTS]=M.layer.WMTS.prototype.equals;var e=t.fnEquals_,n=function(t){return M.utils.isUndefined(this.id)?e[this.type](t):this.id===t.id};M.layer.GeoJSON.prototype.equals=n,M.layer.KML.prototype.equals=n,M.layer.Mapbox.prototype.equals=n,M.layer.OSM.prototype.equals=n,M.layer.WFS.prototype.equals=n,M.layer.WMC.prototype.equals=n,M.layer.WMS.prototype.equals=n,M.layer.WMTS.prototype.equals=n}}},{key:"overrideMapeaCore",value:function(){M.impl.layer.WFS.prototype.getCapabilities=M.impl.layer.WMS.prototype.getCapabilities,M.impl.layer.WMS.prototype.getAbstractLayer=M.impl.layer.WFS.prototype.getAbstractLayer=M.impl.layer.WMTS.prototype.getAbstractLayer=function(){return new Promise(function(t,e){M.utils.isNullOrEmpty(this.abstract_)?this.getCapabilities().then(function(e){var n=null;M.utils.isUndefined(e.getInfoCapabilities)?!M.utils.isUndefined(e.Contents)&&e.Contents.Layer&&(n=e.Contents.Layer[0]):n=e.getInfoCapabilities(this.name),this.abstract_=n?n.Abstract:"",t(this.abstract_)}.bind(this)).catch((function(t){return e(t)})):t(this.abstract_)}.bind(this))},M.impl.layer.WMS.prototype.getMetadataURL=M.impl.layer.WFS.prototype.getMetadataURL=function(){var t=this;return new Promise((function(e,n){M.utils.isNullOrEmpty(t.metadataLink_)?t.getCapabilities().then((function(r){var a=null;t instanceof M.impl.layer.WMTS||(a=r.getInfoCapabilities(t.name)),t.metadataLink_=!!a&&!!a.MetadataURL&&a.MetadataURL[0].OnlineResource;var i=document.createElement("a");i.href=t.url,!t.metadataLink_&&["www.ideandalucia.es","www.callejerodeandalucia.es","www.juntadeandalucia.es"].indexOf(i.hostname)>-1?M.remote.get("http://www.ideandalucia.es/catalogo/inspire/srv/spa/q",{any:t.name},{jsonp:!0}).then((function(n){var r=(new DOMParser).parseFromString(n.text,"text/xml").getElementsByTagName("uuid");r.length&&(t.metadataLink_="http://www.ideandalucia.es/catalogo/inspire/srv/spa/metadata.formatter.html?xsl=metadato_completo&uuid="+r[0].childNodes[0].nodeValue),e(t.metadataLink_)})).catch((function(t){return n(t)})):e(t.metadataLink_)})).catch((function(t){return n(t)})):e(t.metadataLink_)}))},M.impl.layer.WMS.prototype.getStylesLayer=function(){var t=this;return new Promise((function(e,n){M.utils.isNullOrEmpty(t.listStyles_)?t.getCapabilities().then((function(n){var r=n.getInfoCapabilities(t.name);t.listStyles_=M.utils.isNullOrEmpty(r)||M.utils.isNullOrEmpty(r.Style)?[]:r.Style,t.selectedStyle_=0,M.utils.isNullOrEmpty(t.listStyles_[0])||M.utils.isNullOrEmpty(t.listStyles_[0].LegendURL)||t.setLegendURL(t.listStyles_[0].LegendURL[0].OnlineResource),t.listStyles_.forEach((function(e,n){e.Name==t.getOL3Layer().getSource().getParams().STYLES&&(t.selectedStyle_=n,M.utils.isNullOrEmpty(e.LegendURL)||t.setLegendURL(e.LegendURL[0].OnlineResource))})),e(t.listStyles_)})).catch((function(t){return n(t)})):e(t.listStyles_)}))},M.impl.layer.WMS.prototype.getSelectedStyle=function(){return M.utils.isNullOrEmpty(this.listStyles_)?null:this.listStyles_[this.selectedStyle_]},M.impl.layer.WMS.prototype.setSelectedStyle=function(t){if(!M.utils.isNullOrEmpty(this.listStyles_)){var e=this.listStyles_[t];this.getOL3Layer().getSource().updateParams({STYLES:e.Name}),this.selectedStyle_=t,M.utils.isNullOrEmpty(e.LegendURL)||this.setLegendURL(e.LegendURL[0].OnlineResource)}},M.impl.GetCapabilities.prototype.getInfoCapabilities=function(t){var e=null,n=null;for(e in this)if(!M.utils.isNullOrEmpty(this[e])&&!M.utils.isUndefined(this[e].Capability)){n=this[e].Capability;break}var r=null;return M.utils.isNullOrEmpty(n)||(r=this.getInfoCapabilitiesRecursive_(n.Layer,t)),r},M.impl.GetCapabilities.prototype.getInfoCapabilitiesRecursive_=function(t,e){var n,r,a=null;if(!M.utils.isNullOrEmpty(t))if(M.utils.isArray(t))for(n=0,r=t.length;n<r&&null===a;n++)a=this.getInfoCapabilitiesRecursive_(t[n],e);else M.utils.isObject(t)&&(M.utils.isNullOrEmpty(e)||t.Name===e?a=t:M.utils.isUndefined(t.Layer)||(a=this.getInfoCapabilitiesRecursive_(t.Layer,e)));return a},M.impl.Map.prototype.removeItemLayers=function(t){var e=this;return M.utils.isNullOrEmpty(t)&&(t=[]),M.utils.isArray(t)||(t=[t]),t.forEach((function(t){e.layers_=e.layers_.filter((function(e){return e!=t})),t.type!==M.layer.type.MBtiles&&t.type!==M.layer.type.WMC&&t.getImpl().destroy(),t.type==M.layer.type.KML&&!0===t.extract&&e.featuresHandler_.removeLayer(t.getImpl())})),this},M.impl.layer.OSM.prototype.destroy=function(){var t=this.map.getMapImpl();M.utils.isNullOrEmpty(this.ol3Layer)||(t.removeLayer(this.ol3Layer),this.ol3Layer=null),this.map.getLayers().forEach((function(t){(t instanceof M.layer.OSM||t instanceof M.layer.Mapbox)&&(this.haveOSMorMapboxLayer=!0)}),this),this.haveOSMorMapboxLayer||this.map.getImpl().getMapImpl().getControls().getArray().forEach((function(t){t instanceof ol.control.Attribution&&this.map.getImpl().getMapImpl().removeControl(t)}),this),this.map=null},M.impl.Layer.prototype.getLegendURL=function(){return M.utils.isNullOrEmpty(this.legendUrl_)&&(this.legendUrl_=M.utils.concatUrlPaths([M.config.THEME_URL,M.Layer.LEGEND_DEFAULT])),this.legendUrl_},M.impl.Layer.prototype.setLegendURL=function(t){this.legendUrl_=t},M.impl.Map.Z_INDEX={},M.impl.Map.Z_INDEX[M.layer.type.WMC]=1,M.impl.Map.Z_INDEX[M.layer.type.WMS]=1,M.impl.Map.Z_INDEX[M.layer.type.WMTS]=1,M.impl.Map.Z_INDEX[M.layer.type.Mapbox]=1,M.impl.Map.Z_INDEX[M.layer.type.OSM]=1,M.impl.Map.Z_INDEX[M.layer.type.KML]=1,M.impl.Map.Z_INDEX[M.layer.type.WFS]=1}}],(n=null)&&pt(e.prototype,n),r&&pt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),yt=n(5),dt=n.n(yt);function mt(t){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Mt(t);if(e){var a=Mt(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return bt(this,n)}}function bt(t,e){if(e&&("object"===mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Mt(t){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vt(t,e)}(i,t);var e,n,r,a=gt(i);function i(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var r=new p(t),o={controlName:i.NAME,iconClass:"g-cartografia-medir-area",tooltip:"Capas temáticas"};return e=M.utils.extend(o,e,!0),(n=a.call(this,r,t,e)).params_=t||{},n.thematicLayers_=[],n.loadConfigInicial(),n}return e=i,r=[{key:"NAME",get:function(){return"ThematicLayers"}},{key:"TEMPLATE",get:function(){return dt.a}}],(n=[{key:"equals",value:function(t){var e=!1;return t instanceof i&&(e=this.name===t.name),e}},{key:"render",value:function(){this.renderPanel()}},{key:"renderPanel",value:function(){var t=M.template.compileSync(i.TEMPLATE,{vars:this.getTemplateVariables_()});this.getControlContainer_().innerHTML=t.innerHTML}},{key:"addEvents",value:function(t){var e=this;t.querySelector(this.getSelectorContainer_()).addEventListener("click",(function(t){return e.clickThematicLayer(t)}))}},{key:"getTemplateVariables_",value:function(){return{groups:this.params_.groups.map(this.parseGroupForTemplate_,this)}}},{key:"parseGroupForTemplate_",value:function(t,e){var n=this.getOptionsControlManageLayers(t);return M.utils.isNullOrEmpty(n)&&(n={index:e,collapsed:!0,activated:!1},this.setOptionsControlManageLayers(t,n)),{id:t.id,title:t.title,collapsed:!0===n.collapsed,overlays:t.overlays.map(this.parseLayerForTemplate_,this),activated:!0===n.activated}}},{key:"parseLayerForTemplate_",value:function(t,e){var n=t.legend;return M.utils.isNullOrEmpty(n)&&(n=t.name),M.utils.isNullOrEmpty(n)&&(n="Servicio WMS"),{id:t.id,name:t.name,title:n,load:!0===this.isLoadLayer(t)}}},{key:"clickThematicLayer",value:function(t){if(t=t||window.event,!M.utils.isNullOrEmpty(t.target)){var e=t.target,n=e.getAttribute("data-id");if(!M.utils.isNullOrEmpty(n)){t.stopPropagation();var r=this.getControlContainer_(),a=this.getQuerySelectorScapeCSS(r,"#optionsTocGroup_",n);if(e.classList.contains("m-accion-thematiclayers-collapse")){var i=this.findItemByProperty(this.params_.groups,"id",n);this.getOptionsControlManageLayers(i).collapsed=!a.classList.contains("dNone"),e.classList.toggle("g-cartografia-flecha-abajo2"),e.classList.toggle("g-cartografia-flecha-arriba2"),a.classList.toggle("dNone")}else if(e.classList.contains("m-accion-thematiclayers-load-group")){var o=e.classList.contains("g-cartografia-mas2")?"input[type=checkbox]:not(:checked)":"input[type=checkbox]:checked";a.querySelectorAll(o).forEach((function(t,e){t.click()})),e.classList.toggle("g-cartografia-mas2"),e.classList.toggle("g-cartografia-cancelar2"),e.title=e.classList.contains("g-cartografia-mas2")?"Añadir todas las capas del grupo":"Eliminar todas las capas del grupo";var l=this.findItemByProperty(this.params_.groups,"id",n);this.getOptionsControlManageLayers(l).activated=!e.classList.contains("g-cartografia-mas2")}else if(e.classList.contains("m-accion-thematiclayers-load")){var s=this.findItemByProperty(this.thematicLayers_,"id",n);!0==!e.checked?this.removeLayers(s):this.addLayers(s)}}}}},{key:"loadConfigInicial",value:function(){var t=this,e=this.params_.groups;M.utils.isNullOrEmpty(e)&&(e=[]),M.utils.isArray(e)||(e=[e]),e.forEach((function(e,n){M.utils.isNullOrEmpty(e.id)&&(e.id="grp_thematic_"+n,e.index=n),M.utils.isNullOrEmpty(e.options)&&(e.options={}),M.utils.isNullOrEmpty(e.title)&&(e.title="Grupo - "+n),M.utils.isNullOrEmpty(e.overlays)&&(e.overlays=[]),e.overlays=t.loadConfigOverlays(e,e.overlays),t.thematicLayers_=t.thematicLayers_.concat(e.overlays)}),this),this.params_.groups=e}},{key:"loadConfigOverlays",value:function(t,e){return M.utils.isArray(e)||(e=[e]),e.map((function(e,n){var r;if(e instanceof M.Layer)r=e;else try{var a=M.parameter.layer(e);M.utils.isNullOrEmpty(a.type)?M.dialog.error("No se ha especificado un tipo válido para la capa"):r=new M.layer[a.type](e)}catch(t){M.dialog.error("El formato de la capa ("+e+") no se reconoce")}return M.utils.isNullOrEmpty(r.options)&&(r.options={}),r.options.isTematica=!0,r.options.origen="Tematica",M.utils.isNullOrEmpty(r.id)&&(r.id="thematic_"+t.index+"_"+n),r}))}}])&&ht(e.prototype,n),r&&ht(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(E),Lt=n(6),Et=n.n(Lt);function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Tt(t);if(e){var a=Tt(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return kt(this,n)}}function kt(t,e){if(e&&("object"===Ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Nt(t)}function Nt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&St(t,e)}(i,M.Plugin);var e,n,r,a=Ct(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=a.call(this)).name=i.NAME,e.map_=null,e.controls_=[],t=t||{},e.config_=t.config||{},e.params_=t.params||{},e.metadata_=ut.metadata,e.options_=t.options||{},ft.overrideMapeaCore(),ft.initMapeaCoreExtension(Nt(e)),e}return e=i,r=[{key:"NAME",get:function(){return"ManageLayers"}},{key:"TEMPLATE",get:function(){return Et.a}}],(n=[{key:"addTo",value:function(t){var e=this;this.map_=t;var n=this.createView(t);this.toolbar_={target:n,selector:"#toolbar-"+i.NAME.toLowerCase(),selectorBtn:".m-toolbar-buttons",selectorContainer:".m-toolbar-containers"},this.map_.once(M.evt.COMPLETED,(function(){M.utils.isNullOrEmpty(e.params_.metadata)?e.initControls():M.remote.get(e.params_.metadata,null,{jsonp:!1}).then((function(t){!1===t.error||M.dialog.error("Se ha producido un error al cargar la configuración de metadatos","Configuración metadatos"),e.initControls()}))}))}},{key:"getConfigControl",value:function(t){var e=this.config_[t]||{};return e.params=e.params||{},e.options=e.options||{},e.options.toolbar=this.toolbar_,e}},{key:"initControls",value:function(){var t=this,e=null,n=null;n=this.getConfigControl("activeLayers"),e=new F(n.params,n.options),this.addControlToPlugin_(e),n=this.getConfigControl("baseLayers"),e=new ct(n.params,n.options),this.addControlToPlugin_(e),n=this.getConfigControl("thematicLayers"),e=new _t(n.params,n.options),this.addControlToPlugin_(e),this.panel_=this.getPanel_(),this.panel_.addControls(this.controls_),this.panel_.on(M.evt.ADDED_TO_MAP,(function(){return t.fire(M.evt.ADDED_TO_MAP)})),this.map_.addPanels(this.panel_)}},{key:"createView",value:function(t){return M.template.compileSync||(M.template.compileSync=function(t,e){var n,r={};M.utils.isUndefined(e)||(r=M.utils.extends(r,e.vars),n=e.parseToHtml);var a=Handlebars.compile(t)(r);return!1!==n?M.utils.stringToHtml(a):a}),M.template.compileSync(i.TEMPLATE,{})}},{key:"addControlToPlugin_",value:function(t){t.on(M.evt.ACTIVATED,(function(){t.render()})),this.controls_.push(t)}},{key:"getPanel_",value:function(){var t=this,e=M.utils.isNullOrEmpty(this.options_.panel)||M.utils.isNullOrEmpty(this.options_.panel.name)?"managelayers":this.options_.panel.name,n=this.map_.getPanels(e)[0];return M.utils.isNullOrEmpty(n)&&((n=new M.ui.Panel(e,this.getPanelOptions_())).on(M.evt.ADDED_TO_MAP,(function(t){M.utils.enableTouchScroll(t)})),n.on(M.evt.SHOW,(function(e){for(var n=!1,r=t.getControls(),a=0;a<r.length;a++)if(r[a].activated){n=!0;break}n||t.map_.getControls(F.NAME)[0].activate()}))),n}},{key:"getPanelOptions_",value:function(){var t={};return M.utils.isNullOrEmpty(this.options_.panel)||(t=this.options_.panel),{collapsible:!0,className:"m-managelayers"+(M.utils.isNullOrEmpty(t.className)?"":" "+t.className),collapsedButtonClass:M.utils.isNullOrEmpty(t.collapsedClass)?"g-cartografia-capas2":t.collapsedClass,position:M.utils.isNullOrEmpty(t.position)?M.ui.position.TR:t.position,tooltip:M.utils.isNullOrEmpty(t.tooltip)?"Gestor de capas":t.tooltip}}},{key:"getControls",value:function(){return this.controls_}},{key:"destroy",value:function(){this.map_.removeControls(this.controls_),this.map_=null,this.controls_=null,this.panel_=null,this.params_=null,this.options_=null,this.name=null}},{key:"equals",value:function(t){var e=!1;return t instanceof i&&(e=!0),e}},{key:"getMetadata",value:function(){return this.metadata_}}])&&wt(e.prototype,n),r&&wt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(),xt=n(7),At=n.n(xt);function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dt(){return(Dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Rt(t,e);if(r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?t:n):a.value}}).apply(this,arguments)}function Rt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ut(t)););return t}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ut(t);if(e){var a=Ut(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return qt(this,n)}}function qt(t,e){if(e&&("object"===It(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ut(t){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ft=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bt(t,e)}(i,t);var e,n,r,a=Wt(i);function i(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var r=new p(t),o={controlName:i.NAME,iconClass:"g-cartografia-capas",tooltip:"Capas WMC"};return e=M.utils.extend(o,e,!0),(n=a.call(this,r,t,e)).params_=t||{},n}return e=i,r=[{key:"NAME",get:function(){return"WMCLayers"}},{key:"TEMPLATE",get:function(){return At.a}}],(n=[{key:"addTo",value:function(t){var e=this;Dt(Ut(i.prototype),"addTo",this).call(this,t),this.wmc_=this.getWMCSelected(),this.render(),this.map_.on(M.evt.CHANGE_WMC,(function(t){e.wmc_=e.getWMCSelected(),e.render()}),this)}},{key:"getWMCSelected",value:function(){var t=this.map_.getWMC().filter((function(t){return 1==t.selected})),e=t?t[0]:null;return e&&e.layers.forEach((function(t,e){M.utils.isNullOrEmpty(t.id)&&(t.id="WMC_"+e)})),e}},{key:"render",value:function(){this.renderPanel()}},{key:"renderPanel",value:function(){var t=M.template.compileSync(i.TEMPLATE,{vars:this.getTemplateVariables_()});this.getControlContainer_().innerHTML=t.innerHTML}},{key:"addEvents",value:function(t){var e=this;t.querySelector(this.getSelectorContainer_()).addEventListener("click",(function(t){return e.clickWmcLayer(t)}))}},{key:"getTemplateVariables_",value:function(){if(M.utils.isNullOrEmpty(this.wmc_))return{name:"",wmcLayers:[]};var t=this.wmc_.layers.filter((function(t){var e=t.type!==M.layer.type.WMC,n=!(t.type===M.layer.type.WMS&&M.utils.isNullOrEmpty(t.name));return e&&n&&!0}));return{name:this.wmc_.name,wmcLayers:t.map(this.parseLayerForTemplate_,this)}}},{key:"parseLayerForTemplate_",value:function(t){var e=t.legend;return M.utils.isNullOrEmpty(e)&&(e=t.name),M.utils.isNullOrEmpty(e)&&(e="Servicio WMS"),M.utils.isNullOrEmpty(t.options)&&(t.options={}),M.utils.isNullOrEmpty(t.options.origen)&&(t.options.isWMC=!0,t.options.origen="WMC"),{id:t.id,name:t.name,title:e,load:!0===this.isLoadLayer(t)}}},{key:"clickWmcLayer",value:function(t){var e=(t=t||window.event).target;if(!M.utils.isNullOrEmpty(e))if(e.classList.contains("m-accion-wmclayers-load-group")){t.stopPropagation();var n=e.classList.contains("g-cartografia-mas2")?"input[type=checkbox]:not(:checked)":"input[type=checkbox]:checked";this.getControlContainer_().querySelectorAll(n).forEach((function(t,e){t.click()})),e.classList.toggle("g-cartografia-mas2"),e.classList.toggle("g-cartografia-cancelar2"),e.title=e.classList.contains("g-cartografia-mas2")?"Añadir todas las capas":"Eliminar todas las capas"}else{var r=e.getAttribute("data-id");if(!M.utils.isNullOrEmpty(r)){t.stopPropagation();var a=this.findItemByProperty(this.wmc_.layers,"id",r);e.classList.contains("m-accion-wmclayers-load")&&(!0===this.isLoadLayer(a)?(this.removeLayers(a),this.resetOptionsManageLayers(a)):this.addLayers(a))}}}},{key:"equals",value:function(t){var e=!1;return t instanceof i&&(e=this.name===t.name),e}}])&&jt(e.prototype,n),r&&jt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(E);window.M.control||(window.M.control={}),window.M.plugin||(window.M.plugin={}),window.M.impl||(window.M.impl={}),window.M.impl.control||(window.M.impl.control={}),window.M.control.ActiveLayersControl=F,window.M.plugin.BaseLayersControl=ct,window.M.plugin.ManageLayers=Pt,window.M.control.ManageLayersControl=E,window.M.control.ThematicLayersControl=_t,window.M.control.WMCLayersControl=Ft,window.M.impl.control.ActiveLayersControl=T,window.M.impl.control.BaseLayersControl=z,window.M.impl.control.ManageLayersControl=p}]);
//# sourceMappingURL=managelayers.ol.min.js.map